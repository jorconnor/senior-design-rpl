{"vb.dependencies":{"pos":1,"subs":[{"vb.dependency":{"pos":1,"subs":[{"vb.dependency_name":{"pos":9,"text":"System.IO\r"}}],"text":"Imports System.IO\r"}},{"vb.dependency":{"pos":20,"subs":[{"vb.dependency_name":{"pos":28,"text":"System.Text.RegularExpressions\r"}}],"text":"Imports System.Text.RegularExpressions\r"}}],"text":"Imports System.IO\r\nImports System.Text.RegularExpressions\r\n\r\nPublic Class skinList\r\n    Public skinsDirectory As New ArrayList\r\n    Public skinsLabel As New ArrayList\r\n    Public count As Int16 = 0\r\n    Public Sub New(path As String)\r\n        Dim dirInfo = New DirectoryInfo(path + \"\\skins\").GetDirectories\r\n        Dim skinPathRgx = New Regex(\"Metro For Steam\", RegexOptions.IgnoreCase)\r\n        Dim versionRgx = New Regex(\"[0-9]\\.[0-9](\\.[0-9]|)\")\r\n        For Each folder In dirInfo\r\n            Dim temppath = folder.Name.ToString()\r\n\r\n            Dim menufile = path + \"\\skins\\\" + temppath + \"\\resource\\menus\\steam.menu\"\r\n\r\n            If File.Exists(menufile) Then\r\n                Dim menufileb = New readFile(menufile)\r\n                Dim menufile_contents = menufileb.contents\r\n                If skinPathRgx.IsMatch(menufile_contents) Then\r\n                    Dim version_match = versionRgx.Match(menufile_contents)\r\n                    If versionRgx.IsMatch(menufile_contents) Then\r\n                        skinsDirectory.Add(temppath)\r\n                        skinsLabel.Add(temppath + \" [\" + version_match.ToString + \"]\")\r\n                        count += 1\r\n                    End If\r\n                End If\r\n            End If\r\n        Next\r\n    End Sub\r\n"}}
