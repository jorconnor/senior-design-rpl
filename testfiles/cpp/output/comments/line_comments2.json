{"cpp.line_comments":{"pos":1,"text":"#include \"CPU.h\"\nusing namespace FAES;\n\nbool CPU::cpuidSupported() {\n  \/\/ This method uses the ID flag in bit 21 of the EFLAGS register. If\n  \/\/ software can change the value of this flag, the CPUID instruction\n  \/\/ is executable.\n  unsigned int res;\n  __asm__ (\"mov %%ecx, %%eax;\"\n           \"xor $200000, %%eax;\"\n           \"xor %%ecx, %%eax;\"\n           \"je no;\"\n           \"mov $1, %%eax;\"\n           \"jmp end;\"\n           \"no: mov $0, %%eax;\"\n           \"end:;\"\n           : \"=a\" (res)\n           :\n           : \"cc\"); \n  \n  return res > 0;\n}\n\nvoid CPU::cpuid(unsigned int opcode, unsigned int result[4]) {\n  if (!cpuidSupported()) return;\n\n  \/\/ PIC compliant version\n  __asm__ (\"cpuid;\"\n           \"movl %%ebx, %1;\" \n           : \"=a\" (result[0]), \/\/ EAX register -> result[0]\n             \"=r\" (result[1]), \/\/ EBX register -> result[1]\n             \"=c\" (result[2]), \/\/ ECX register -> result[2]\n             \"=d\" (result[3])  \/\/ EDX register -> result[3]\n           : \"0\" (opcode)\n           : \"cc\");\n}\n\nbool CPU::sse41Supported() {\n  CPUFeatures2_t features;\n  unsigned int res[4];\n  cpuid(1, res);\n  features.raw_data = res[3];\n  return features.features.SSE4_1 == 1;  \n}\n\nbool CPU::aesSupported() {\n  CPUFeatures2_t features;\n  unsigned int res[4];\n  cpuid(1, res);\n  features.raw_data = res[3];\n  return features.features.AES == 1;\n}\n","subs":[{"cpp.line_comment":{"pos":70,"text":"  \/\/ This method uses the ID flag in bit 21 of the EFLAGS register. If","subs":[{"cpp.line_comment_context":{"pos":70,"text":"  "}},{"cpp.line_comment_body":{"pos":72,"text":"\/\/ This method uses the ID flag in bit 21 of the EFLAGS register. If","subs":[{"cpp.line_comment_text":{"pos":74,"text":" This method uses the ID flag in bit 21 of the EFLAGS register. If"}}]}}]}},{"cpp.line_comment":{"pos":141,"text":"  \/\/ software can change the value of this flag, the CPUID instruction","subs":[{"cpp.line_comment_context":{"pos":141,"text":"  "}},{"cpp.line_comment_body":{"pos":143,"text":"\/\/ software can change the value of this flag, the CPUID instruction","subs":[{"cpp.line_comment_text":{"pos":145,"text":" software can change the value of this flag, the CPUID instruction"}}]}}]}},{"cpp.line_comment":{"pos":212,"text":"  \/\/ is executable.","subs":[{"cpp.line_comment_context":{"pos":212,"text":"  "}},{"cpp.line_comment_body":{"pos":214,"text":"\/\/ is executable.","subs":[{"cpp.line_comment_text":{"pos":216,"text":" is executable."}}]}}]}},{"cpp.line_comment":{"pos":647,"text":"  \/\/ PIC compliant version","subs":[{"cpp.line_comment_context":{"pos":647,"text":"  "}},{"cpp.line_comment_body":{"pos":649,"text":"\/\/ PIC compliant version","subs":[{"cpp.line_comment_text":{"pos":651,"text":" PIC compliant version"}}]}}]}},{"cpp.line_comment":{"pos":724,"text":"           : \"=a\" (result[0]), \/\/ EAX register -> result[0]","subs":[{"cpp.line_comment_context":{"pos":724,"text":"           : \"=a\" (result[0]), "}},{"cpp.line_comment_body":{"pos":755,"text":"\/\/ EAX register -> result[0]","subs":[{"cpp.line_comment_text":{"pos":757,"text":" EAX register -> result[0]"}}]}}]}},{"cpp.line_comment":{"pos":784,"text":"             \"=r\" (result[1]), \/\/ EBX register -> result[1]","subs":[{"cpp.line_comment_context":{"pos":784,"text":"             \"=r\" (result[1]), "}},{"cpp.line_comment_body":{"pos":815,"text":"\/\/ EBX register -> result[1]","subs":[{"cpp.line_comment_text":{"pos":817,"text":" EBX register -> result[1]"}}]}}]}},{"cpp.line_comment":{"pos":844,"text":"             \"=c\" (result[2]), \/\/ ECX register -> result[2]","subs":[{"cpp.line_comment_context":{"pos":844,"text":"             \"=c\" (result[2]), "}},{"cpp.line_comment_body":{"pos":875,"text":"\/\/ ECX register -> result[2]","subs":[{"cpp.line_comment_text":{"pos":877,"text":" ECX register -> result[2]"}}]}}]}},{"cpp.line_comment":{"pos":904,"text":"             \"=d\" (result[3])  \/\/ EDX register -> result[3]","subs":[{"cpp.line_comment_context":{"pos":904,"text":"             \"=d\" (result[3])  "}},{"cpp.line_comment_body":{"pos":935,"text":"\/\/ EDX register -> result[3]","subs":[{"cpp.line_comment_text":{"pos":937,"text":" EDX register -> result[3]"}}]}}]}}]}}
