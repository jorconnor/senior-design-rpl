{"cs.line_comments":{"subs":[{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":180,"text":"   "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":185,"text":"\/ <summary>"}}],"pos":183,"text":"\/\/\/ <summary>"}}],"pos":180,"text":"   \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":197,"text":"   "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":202,"text":"\/ Static class providing access to information about the operating system under which the"}}],"pos":200,"text":"\/\/\/ Static class providing access to information about the operating system under which the"}}],"pos":197,"text":"   \/\/\/ Static class providing access to information about the operating system under which the"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":292,"text":"   "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":297,"text":"\/ assembly is executing."}}],"pos":295,"text":"\/\/\/ assembly is executing."}}],"pos":292,"text":"   \/\/\/ assembly is executing."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":322,"text":"   "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":327,"text":"\/ <\/summary>"}}],"pos":325,"text":"\/\/\/ <\/summary>"}}],"pos":322,"text":"   \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":421,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":429,"text":"\/ <summary>"}}],"pos":427,"text":"\/\/\/ <summary>"}}],"pos":421,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":441,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":449,"text":"\/ Gets the named version of the operating system."}}],"pos":447,"text":"\/\/\/ Gets the named version of the operating system."}}],"pos":441,"text":"      \/\/\/ Gets the named version of the operating system."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":499,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":507,"text":"\/ <\/summary>"}}],"pos":505,"text":"\/\/\/ <\/summary>"}}],"pos":499,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":520,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":528,"text":"\/ <value>The named version of the operating system.<\/value>"}}],"pos":526,"text":"\/\/\/ <value>The named version of the operating system.<\/value>"}}],"pos":520,"text":"      \/\/\/ <value>The named version of the operating system.<\/value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":808,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":816,"text":"\/ <summary>"}}],"pos":814,"text":"\/\/\/ <summary>"}}],"pos":808,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":828,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":836,"text":"\/ Gets a value indicating whether the operating system is a server os."}}],"pos":834,"text":"\/\/\/ Gets a value indicating whether the operating system is a server os."}}],"pos":828,"text":"      \/\/\/ Gets a value indicating whether the operating system is a server os."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":907,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":915,"text":"\/ <\/summary>"}}],"pos":913,"text":"\/\/\/ <\/summary>"}}],"pos":907,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":928,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":936,"text":"\/ <value>"}}],"pos":934,"text":"\/\/\/ <value>"}}],"pos":928,"text":"      \/\/\/ <value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":946,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":954,"text":"\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>."}}],"pos":952,"text":"\/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>."}}],"pos":946,"text":"      \/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1043,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1051,"text":"\/ <\/value>"}}],"pos":1049,"text":"\/\/\/ <\/value>"}}],"pos":1043,"text":"      \/\/\/ <\/value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1254,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1262,"text":"\/ <summary>"}}],"pos":1260,"text":"\/\/\/ <summary>"}}],"pos":1254,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1274,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1282,"text":"\/ Gets the numeric version of the operating system. This is the same as returned by "}}],"pos":1280,"text":"\/\/\/ Gets the numeric version of the operating system. This is the same as returned by "}}],"pos":1274,"text":"      \/\/\/ Gets the numeric version of the operating system. This is the same as returned by "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1367,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1375,"text":"\/ <see cref=\"System.Environment.OSVersion\"\/>."}}],"pos":1373,"text":"\/\/\/ <see cref=\"System.Environment.OSVersion\"\/>."}}],"pos":1367,"text":"      \/\/\/ <see cref=\"System.Environment.OSVersion\"\/>."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1421,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1429,"text":"\/ <\/summary>"}}],"pos":1427,"text":"\/\/\/ <\/summary>"}}],"pos":1421,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1442,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1450,"text":"\/ <value>The numeric version of the operating system.<\/value>"}}],"pos":1448,"text":"\/\/\/ <value>The numeric version of the operating system.<\/value>"}}],"pos":1442,"text":"      \/\/\/ <value>The numeric version of the operating system.<\/value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1604,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1612,"text":"\/ <summary>"}}],"pos":1610,"text":"\/\/\/ <summary>"}}],"pos":1604,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1624,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1632,"text":"\/ Gets the version of the service pack currently installed on the operating system."}}],"pos":1630,"text":"\/\/\/ Gets the version of the service pack currently installed on the operating system."}}],"pos":1624,"text":"      \/\/\/ Gets the version of the service pack currently installed on the operating system."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1716,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1724,"text":"\/ <\/summary>"}}],"pos":1722,"text":"\/\/\/ <\/summary>"}}],"pos":1716,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1737,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1745,"text":"\/ <value>The version of the service pack currently installed on the operating system.<\/value>"}}],"pos":1743,"text":"\/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>"}}],"pos":1737,"text":"      \/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1839,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1847,"text":"\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are "}}],"pos":1845,"text":"\/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are "}}],"pos":1839,"text":"      \/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":1939,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":1947,"text":"\/ used.<\/remarks>"}}],"pos":1945,"text":"\/\/\/ used.<\/remarks>"}}],"pos":1939,"text":"      \/\/\/ used.<\/remarks>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2189,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2197,"text":"\/ <summary>"}}],"pos":2195,"text":"\/\/\/ <summary>"}}],"pos":2189,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2209,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2217,"text":"\/ Gets the processor architecture for which the operating system is targeted."}}],"pos":2215,"text":"\/\/\/ Gets the processor architecture for which the operating system is targeted."}}],"pos":2209,"text":"      \/\/\/ Gets the processor architecture for which the operating system is targeted."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2295,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2303,"text":"\/ <\/summary>"}}],"pos":2301,"text":"\/\/\/ <\/summary>"}}],"pos":2295,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2316,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2324,"text":"\/ <value>The processor architecture for which the operating system is targeted.<\/value>"}}],"pos":2322,"text":"\/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>"}}],"pos":2316,"text":"      \/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2412,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2420,"text":"\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to"}}],"pos":2418,"text":"\/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to"}}],"pos":2412,"text":"      \/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2527,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2535,"text":"\/ determine if this is the case."}}],"pos":2533,"text":"\/\/\/ determine if this is the case."}}],"pos":2527,"text":"      \/\/\/ determine if this is the case."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2568,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2576,"text":"\/ <\/remarks>"}}],"pos":2574,"text":"\/\/\/ <\/remarks>"}}],"pos":2568,"text":"      \/\/\/ <\/remarks>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2887,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2895,"text":"\/ <summary>"}}],"pos":2893,"text":"\/\/\/ <summary>"}}],"pos":2887,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2907,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2915,"text":"\/ Determines whether the current process is running under WOW64."}}],"pos":2913,"text":"\/\/\/ Determines whether the current process is running under WOW64."}}],"pos":2907,"text":"      \/\/\/ Determines whether the current process is running under WOW64."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":2980,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":2988,"text":"\/ <\/summary>"}}],"pos":2986,"text":"\/\/\/ <\/summary>"}}],"pos":2980,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3001,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3009,"text":"\/ <returns>"}}],"pos":3007,"text":"\/\/\/ <returns>"}}],"pos":3001,"text":"      \/\/\/ <returns>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3021,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3029,"text":"\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>."}}],"pos":3027,"text":"\/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>."}}],"pos":3021,"text":"      \/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3116,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3124,"text":"\/ <\/returns>      "}}],"pos":3122,"text":"\/\/\/ <\/returns>      "}}],"pos":3116,"text":"      \/\/\/ <\/returns>      "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3503,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3511,"text":"\/ <summary>"}}],"pos":3509,"text":"\/\/\/ <summary>"}}],"pos":3503,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3523,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3531,"text":"\/ Determines whether the operating system is of the specified version or later."}}],"pos":3529,"text":"\/\/\/ Determines whether the operating system is of the specified version or later."}}],"pos":3523,"text":"      \/\/\/ Determines whether the operating system is of the specified version or later."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3611,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3619,"text":"\/ <\/summary>"}}],"pos":3617,"text":"\/\/\/ <\/summary>"}}],"pos":3611,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3632,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3640,"text":"\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>"}}],"pos":3638,"text":"\/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>"}}],"pos":3632,"text":"      \/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3724,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3732,"text":"\/ <returns>"}}],"pos":3730,"text":"\/\/\/ <returns>"}}],"pos":3724,"text":"      \/\/\/ <returns>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3744,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3752,"text":"\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>."}}],"pos":3750,"text":"\/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>."}}],"pos":3744,"text":"      \/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":3873,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":3881,"text":"\/ <\/returns>      "}}],"pos":3879,"text":"\/\/\/ <\/returns>      "}}],"pos":3873,"text":"      \/\/\/ <\/returns>      "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4017,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4025,"text":"\/ <summary>"}}],"pos":4023,"text":"\/\/\/ <summary>"}}],"pos":4017,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4037,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4045,"text":"\/ Determines whether operating system is of the specified version or later, allowing specification of "}}],"pos":4043,"text":"\/\/\/ Determines whether operating system is of the specified version or later, allowing specification of "}}],"pos":4037,"text":"      \/\/\/ Determines whether operating system is of the specified version or later, allowing specification of "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4148,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4156,"text":"\/ a minimum service pack that must be installed on the lowest version."}}],"pos":4154,"text":"\/\/\/ a minimum service pack that must be installed on the lowest version."}}],"pos":4148,"text":"      \/\/\/ a minimum service pack that must be installed on the lowest version."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4227,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4235,"text":"\/ <\/summary>"}}],"pos":4233,"text":"\/\/\/ <\/summary>"}}],"pos":4227,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4248,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4256,"text":"\/ <param name=\"version\">The minimum required version.<\/param>"}}],"pos":4254,"text":"\/\/\/ <param name=\"version\">The minimum required version.<\/param>"}}],"pos":4248,"text":"      \/\/\/ <param name=\"version\">The minimum required version.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4318,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4326,"text":"\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the "}}],"pos":4324,"text":"\/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the "}}],"pos":4318,"text":"      \/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4430,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4438,"text":"\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>"}}],"pos":4436,"text":"\/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>"}}],"pos":4430,"text":"      \/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4556,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4564,"text":"\/ <returns>"}}],"pos":4562,"text":"\/\/\/ <returns>"}}],"pos":4556,"text":"      \/\/\/ <returns>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4576,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4584,"text":"\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>."}}],"pos":4582,"text":"\/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>."}}],"pos":4576,"text":"      \/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":4780,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":4788,"text":"\/ <\/returns>      "}}],"pos":4786,"text":"\/\/\/ <\/returns>      "}}],"pos":4780,"text":"      \/\/\/ <\/returns>      "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5025,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5033,"text":"\/ <summary>"}}],"pos":5031,"text":"\/\/\/ <summary>"}}],"pos":5025,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5045,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5053,"text":"\/ Determines whether operating system is of the specified server version or later or if it is of the specified client "}}],"pos":5051,"text":"\/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client "}}],"pos":5045,"text":"      \/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5172,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5180,"text":"\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}}],"pos":5178,"text":"\/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}}],"pos":5172,"text":"      \/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5271,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5279,"text":"\/ <\/summary>"}}],"pos":5277,"text":"\/\/\/ <\/summary>"}}],"pos":5271,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5292,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5300,"text":"\/ <param name=\"serverVersion\">The minimum server version.<\/param>"}}],"pos":5298,"text":"\/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>"}}],"pos":5292,"text":"      \/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5366,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5374,"text":"\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>"}}],"pos":5372,"text":"\/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>"}}],"pos":5366,"text":"      \/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5539,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5547,"text":"\/ <param name=\"clientVersion\">The minimum client version.<\/param>"}}],"pos":5545,"text":"\/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>"}}],"pos":5539,"text":"      \/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":5613,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":5621,"text":"\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>"}}],"pos":5619,"text":"\/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>"}}],"pos":5613,"text":"      \/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6182,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6190,"text":"\/ <summary>"}}],"pos":6188,"text":"\/\/\/ <summary>"}}],"pos":6182,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6202,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6210,"text":"\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and"}}],"pos":6208,"text":"\/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and"}}],"pos":6202,"text":"      \/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6343,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6351,"text":"\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}}],"pos":6349,"text":"\/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}}],"pos":6343,"text":"      \/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6472,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6480,"text":"\/ <\/summary>"}}],"pos":6478,"text":"\/\/\/ <\/summary>"}}],"pos":6472,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6493,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6501,"text":"\/ <param name=\"serverVersion\">The server version.<\/param>"}}],"pos":6499,"text":"\/\/\/ <param name=\"serverVersion\">The server version.<\/param>"}}],"pos":6493,"text":"      \/\/\/ <param name=\"serverVersion\">The server version.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6559,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6567,"text":"\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>"}}],"pos":6565,"text":"\/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>"}}],"pos":6559,"text":"      \/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6904,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6912,"text":"\/ <summary>"}}],"pos":6910,"text":"\/\/\/ <summary>"}}],"pos":6904,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":6924,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":6932,"text":"\/     Determines whether the assembly is executing on the specified operating system version or later."}}],"pos":6930,"text":"\/\/\/     Determines whether the assembly is executing on the specified operating system version or later."}}],"pos":6924,"text":"      \/\/\/     Determines whether the assembly is executing on the specified operating system version or later."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7035,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7043,"text":"\/     If not, an exception is thrown."}}],"pos":7041,"text":"\/\/\/     If not, an exception is thrown."}}],"pos":7035,"text":"      \/\/\/     If not, an exception is thrown."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7081,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7089,"text":"\/ <\/summary>"}}],"pos":7087,"text":"\/\/\/ <\/summary>"}}],"pos":7081,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7102,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7110,"text":"\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}}],"pos":7108,"text":"\/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}}],"pos":7102,"text":"      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7191,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7199,"text":"\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      "}}],"pos":7197,"text":"\/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      "}}],"pos":7191,"text":"      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7553,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7561,"text":"\/ <summary>"}}],"pos":7559,"text":"\/\/\/ <summary>"}}],"pos":7553,"text":"      \/\/\/ <summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7573,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7581,"text":"\/     Determines whether the assembly is executing on the specified operating system version with"}}],"pos":7579,"text":"\/\/\/     Determines whether the assembly is executing on the specified operating system version with"}}],"pos":7573,"text":"      \/\/\/     Determines whether the assembly is executing on the specified operating system version with"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7679,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7687,"text":"\/     the specified service pack installed or any later version of windows. If not, an exception is thrown."}}],"pos":7685,"text":"\/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown."}}],"pos":7679,"text":"      \/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown."}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7795,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7803,"text":"\/ <\/summary>"}}],"pos":7801,"text":"\/\/\/ <\/summary>"}}],"pos":7795,"text":"      \/\/\/ <\/summary>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7816,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7824,"text":"\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}}],"pos":7822,"text":"\/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}}],"pos":7816,"text":"      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7905,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":7913,"text":"\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>"}}],"pos":7911,"text":"\/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>"}}],"pos":7905,"text":"      \/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":7999,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":8007,"text":"\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier "}}],"pos":8005,"text":"\/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier "}}],"pos":7999,"text":"      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":8117,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":8125,"text":"\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not "}}],"pos":8123,"text":"\/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not "}}],"pos":8117,"text":"      \/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":8232,"text":"      "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":8240,"text":"\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      "}}],"pos":8238,"text":"\/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      "}}],"pos":8232,"text":"      \/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      "}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":9849,"text":"            if (info.dwMinorVersion == 0) "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":9893,"text":" Windows Vista or Windows Server 2008"}}],"pos":9891,"text":"\/\/ Windows Vista or Windows Server 2008"}}],"pos":9849,"text":"            if (info.dwMinorVersion == 0) \/\/ Windows Vista or Windows Server 2008"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":9945,"text":"               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":10021,"text":" Vista"}}],"pos":10019,"text":"\/\/ Vista"}}],"pos":9945,"text":"               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) \/\/ Vista"}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"pos":10263,"text":"            else if (info.dwMinorVersion == 1) "}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"pos":10312,"text":" Windows 7 or Windows Server 2008 R2"}}],"pos":10310,"text":"\/\/ Windows 7 or Windows Server 2008 R2"}}],"pos":10263,"text":"            else if (info.dwMinorVersion == 1) \/\/ Windows 7 or Windows Server 2008 R2"}}],"pos":1,"text":"using System;\nusing System.Diagnostics;\nusing System.Globalization;\nusing System.Runtime.InteropServices;\nusing System.Security.Permissions;\n\nnamespace Alphaleonis.Win32.Vss\n{   \n   \/\/\/ <summary>\n   \/\/\/ Static class providing access to information about the operating system under which the\n   \/\/\/ assembly is executing.\n   \/\/\/ <\/summary>\n   public static class OperatingSystemInfo\n   {\n      #region Public Properties\n\n      \/\/\/ <summary>\n      \/\/\/ Gets the named version of the operating system.\n      \/\/\/ <\/summary>\n      \/\/\/ <value>The named version of the operating system.<\/value>\n      public static OSVersionName OSVersionName\n      {         \n         get\n         {\n            if (s_servicePackVersion == null)\n               UpdateData();\n            return s_osVersionName;\n         }\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Gets a value indicating whether the operating system is a server os.\n      \/\/\/ <\/summary>\n      \/\/\/ <value>\n      \/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>.\n      \/\/\/ <\/value>\n      public static bool IsServer\n      {\n         get\n         {\n            if (s_servicePackVersion == null)\n               UpdateData();\n            return s_isServer;\n         }\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Gets the numeric version of the operating system. This is the same as returned by \n      \/\/\/ <see cref=\"System.Environment.OSVersion\"\/>.\n      \/\/\/ <\/summary>\n      \/\/\/ <value>The numeric version of the operating system.<\/value>\n      public static Version OSVersion\n      {\n         get { return s_osVersion; }\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Gets the version of the service pack currently installed on the operating system.\n      \/\/\/ <\/summary>\n      \/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>\n      \/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are \n      \/\/\/ used.<\/remarks>\n      public static Version ServicePackVersion\n      {         \n         get\n         {\n            if (s_servicePackVersion == null)\n               UpdateData();\n            return s_servicePackVersion;\n         }\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Gets the processor architecture for which the operating system is targeted.\n      \/\/\/ <\/summary>\n      \/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>\n      \/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to\n      \/\/\/ determine if this is the case.\n      \/\/\/ <\/remarks>\n      public static ProcessorArchitecture ProcessorArchitecture\n      {         \n         get\n         {\n            if (s_servicePackVersion == null)\n               UpdateData();\n            return s_processorArchitecture;\n         }\n      }\n\n      #endregion\n\n      #region Public Methods\n      \n      \/\/\/ <summary>\n      \/\/\/ Determines whether the current process is running under WOW64.\n      \/\/\/ <\/summary>\n      \/\/\/ <returns>\n      \/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>.\n      \/\/\/ <\/returns>      \n      public static bool IsWow64Process()\n      {\n         IntPtr processHandle = System.Diagnostics.Process.GetCurrentProcess().Handle;\n         bool value = false;\n         if (!NativeMethods.IsWow64Process(processHandle, out value))\n         {\n            Marshal.ThrowExceptionForHR(Marshal.GetLastWin32Error());\n         }\n         return value;\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Determines whether the operating system is of the specified version or later.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>\n      \/\/\/ <returns>\n      \/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>.\n      \/\/\/ <\/returns>      \n      public static bool IsAtLeast(OSVersionName version)\n      {\n         return OSVersionName >= version;\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Determines whether operating system is of the specified version or later, allowing specification of \n      \/\/\/ a minimum service pack that must be installed on the lowest version.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"version\">The minimum required version.<\/param>\n      \/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the \n      \/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>\n      \/\/\/ <returns>\n      \/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>.\n      \/\/\/ <\/returns>      \n      public static bool IsAtLeast(OSVersionName version, int servicePackVersion)\n      {\n         return OSVersionName == version && ServicePackVersion.Major >= servicePackVersion || OSVersionName > version;\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client \n      \/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>\n      \/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>\n      \/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>\n      \/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>\n      public static void RequireServerOrClientAtLeast(OSVersionName serverVersion, int serverServicePackVersion, OSVersionName clientVersion, int clientServicePackVersion)\n      {\n         if (IsServer && !IsAtLeast(serverVersion, serverServicePackVersion) || !IsServer && !IsAtLeast(clientVersion, clientServicePackVersion))\n            throw new UnsupportedOperatingSystemException();\n      }\n\n      \/\/\/ <summary>\n      \/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and\n      \/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"serverVersion\">The server version.<\/param>\n      \/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>\n      public static void RequireServer(OSVersionName serverVersion, int serverServicePackVersion)\n      {\n         if (!IsServer || !IsAtLeast(serverVersion, serverServicePackVersion))\n            throw new UnsupportedOperatingSystemException();\n      }\n\n      \/\/\/ <summary>\n      \/\/\/     Determines whether the assembly is executing on the specified operating system version or later.\n      \/\/\/     If not, an exception is thrown.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\n      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      \n      public static void RequireAtLeast(OSVersionName osVersion)\n      {\n         if (!IsAtLeast(osVersion))\n            throw new UnsupportedOperatingSystemException();\n      }\n\n      \/\/\/ <summary>\n      \/\/\/     Determines whether the assembly is executing on the specified operating system version with\n      \/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown.\n      \/\/\/ <\/summary>\n      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\n      \/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>\n      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier \n      \/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not \n      \/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      \n      public static void RequireAtLeast(OSVersionName osVersion, int servicePackVersion)\n      {\n         if (!IsAtLeast(osVersion, servicePackVersion))\n            throw new UnsupportedOperatingSystemException();\n      }\n\n      #endregion\n\n      #region Private members            \n      \n      private static void UpdateData()\n      {\n         NativeMethods.OSVERSIONINFOEX info = new NativeMethods.OSVERSIONINFOEX();\n         info.dwOSVersionInfoSize = Marshal.SizeOf(info);\n\n         NativeMethods.SYSTEM_INFO sysInfo = new NativeMethods.SYSTEM_INFO();\n\n         NativeMethods.GetSystemInfo(out sysInfo);\n         if (!NativeMethods.GetVersionExW(ref info))\n         {\n            Marshal.ThrowExceptionForHR(Marshal.GetLastWin32Error());\n         }\n\n         Debug.Assert(info.dwMajorVersion == Environment.OSVersion.Version.Major);\n         Debug.Assert(info.dwMinorVersion == Environment.OSVersion.Version.Minor);\n         Debug.Assert(info.dwBuildNumber == Environment.OSVersion.Version.Build);\n\n         s_processorArchitecture = (ProcessorArchitecture)sysInfo.processorArchitecture;\n\n         s_servicePackVersion = new Version(info.wServicePackMajor, info.wServicePackMinor);\n\n         s_isServer = info.wProductType == NativeMethods.VER_NT_DOMAIN_CONTROLLER || info.wProductType == NativeMethods.VER_NT_SERVER;\n\n         if (info.dwMajorVersion > 6)\n         {\n            s_osVersionName = OSVersionName.Later;\n         }\n         else if (info.dwMajorVersion == 6) \n         {\n            if (info.dwMinorVersion == 0) \/\/ Windows Vista or Windows Server 2008\n            {\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) \/\/ Vista\n               {\n                  s_osVersionName = OSVersionName.WindowsVista;\n               }\n               else\n               {\n                  s_osVersionName = OSVersionName.WindowsServer2008;\n               }\n            }\n            else if (info.dwMinorVersion == 1) \/\/ Windows 7 or Windows Server 2008 R2\n            {\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION)\n               {\n                  s_osVersionName = Vss.OSVersionName.Windows7;\n               }\n               else\n               {\n                  s_osVersionName = Vss.OSVersionName.WindowsServer2008R2;\n               }\n            }\n            else\n            {\n               s_osVersionName = Vss.OSVersionName.Later;\n            }\n         }\n         else if (info.dwMajorVersion == 5)\n         {\n            if (info.dwMinorVersion == 0)\n            {\n               s_osVersionName = OSVersionName.Windows2000;\n            }\n            if (info.dwMinorVersion == 1)\n            {\n               s_osVersionName = OSVersionName.WindowsXP;\n            }\n            else if (info.dwMinorVersion == 2)\n            {\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION && s_processorArchitecture == ProcessorArchitecture.X64)\n               {\n                  s_osVersionName = OSVersionName.WindowsXP;\n               }\n               else if (info.wProductType != NativeMethods.VER_NT_WORKSTATION)\n               {\n                  s_osVersionName = OSVersionName.WindowsServer2003;\n               }\n               else\n               {\n                  s_osVersionName = OSVersionName.Later;\n               }\n            }\n            else\n            {\n               s_osVersionName = OSVersionName.Later;\n            }\n         }\n      }\n\n      private static OSVersionName s_osVersionName = OSVersionName.Later;\n      private static Version s_osVersion = Environment.OSVersion.Version;\n      private static Version s_servicePackVersion;\n      private static ProcessorArchitecture s_processorArchitecture;\n      private static bool s_isServer;\n\n      #endregion\n\n      #region P\/Invoke members\n\n      private static class NativeMethods\n      {\n         [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\n         public struct OSVERSIONINFOEX\n         {\n            public int dwOSVersionInfoSize;\n            public int dwMajorVersion;\n            public int dwMinorVersion;\n            public int dwBuildNumber;\n            public int dwPlatformId;\n            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]\n            public string szCSDVersion;\n            public UInt16 wServicePackMajor;\n            public UInt16 wServicePackMinor;\n            public UInt16 wSuiteMask;\n            public byte wProductType;\n            public byte wReserved;\n         }\n\n         [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2205:UseManagedEquivalentsOfWin32Api\")]\n         [DllImport(\"kernel32\", CharSet = CharSet.Unicode, SetLastError = true)]\n         [return: MarshalAs(UnmanagedType.Bool)]\n         public static extern bool GetVersionExW(ref OSVERSIONINFOEX osvi);\n\n         [StructLayout(LayoutKind.Sequential)]\n         public struct SYSTEM_INFO\n         {\n            public ushort processorArchitecture;\n            ushort reserved;\n            public uint pageSize;\n            public IntPtr minimumApplicationAddress;\n            public IntPtr maximumApplicationAddress;\n            public IntPtr activeProcessorMask;\n            public uint numberOfProcessors;\n            public uint processorType;\n            public uint allocationGranularity;\n            public ushort processorLevel;\n            public ushort processorRevision;\n         }\n\n         [DllImport(\"kernel32.dll\")]\n         public static extern void GetSystemInfo(out SYSTEM_INFO lpSystemInfo);\n\n         public const short VER_NT_WORKSTATION = 1;\n         public const short VER_NT_DOMAIN_CONTROLLER = 2;\n         public const short VER_NT_SERVER = 3;\n\n         [DllImport(\"kernel32.dll\", SetLastError = true, CallingConvention = CallingConvention.Winapi)]\n         [return: MarshalAs(UnmanagedType.Bool)]\n         public static extern bool IsWow64Process(\n              [In] IntPtr hProcess,\n              [Out, MarshalAs(UnmanagedType.Bool)] out bool lpSystemInfo\n              );\n      }\n      #endregion\n   }\n"}}
