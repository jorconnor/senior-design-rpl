{"cs.line_comments":{"subs":[{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"   ","pos":188}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":193}}],"text":"\/\/\/ <summary>\r","pos":191}}],"text":"   \/\/\/ <summary>\r","pos":188}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"   ","pos":206}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Static class providing access to information about the operating system under which the\r","pos":211}}],"text":"\/\/\/ Static class providing access to information about the operating system under which the\r","pos":209}}],"text":"   \/\/\/ Static class providing access to information about the operating system under which the\r","pos":206}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"   ","pos":302}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ assembly is executing.\r","pos":307}}],"text":"\/\/\/ assembly is executing.\r","pos":305}}],"text":"   \/\/\/ assembly is executing.\r","pos":302}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"   ","pos":333}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":338}}],"text":"\/\/\/ <\/summary>\r","pos":336}}],"text":"   \/\/\/ <\/summary>\r","pos":333}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":437}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":445}}],"text":"\/\/\/ <summary>\r","pos":443}}],"text":"      \/\/\/ <summary>\r","pos":437}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":458}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Gets the named version of the operating system.\r","pos":466}}],"text":"\/\/\/ Gets the named version of the operating system.\r","pos":464}}],"text":"      \/\/\/ Gets the named version of the operating system.\r","pos":458}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":517}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":525}}],"text":"\/\/\/ <\/summary>\r","pos":523}}],"text":"      \/\/\/ <\/summary>\r","pos":517}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":539}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <value>The named version of the operating system.<\/value>\r","pos":547}}],"text":"\/\/\/ <value>The named version of the operating system.<\/value>\r","pos":545}}],"text":"      \/\/\/ <value>The named version of the operating system.<\/value>\r","pos":539}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":838}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":846}}],"text":"\/\/\/ <summary>\r","pos":844}}],"text":"      \/\/\/ <summary>\r","pos":838}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":859}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Gets a value indicating whether the operating system is a server os.\r","pos":867}}],"text":"\/\/\/ Gets a value indicating whether the operating system is a server os.\r","pos":865}}],"text":"      \/\/\/ Gets a value indicating whether the operating system is a server os.\r","pos":859}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":939}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":947}}],"text":"\/\/\/ <\/summary>\r","pos":945}}],"text":"      \/\/\/ <\/summary>\r","pos":939}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":961}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <value>\r","pos":969}}],"text":"\/\/\/ <value>\r","pos":967}}],"text":"      \/\/\/ <value>\r","pos":961}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":980}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>.\r","pos":988}}],"text":"\/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>.\r","pos":986}}],"text":"      \/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>.\r","pos":980}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1078}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/value>\r","pos":1086}}],"text":"\/\/\/ <\/value>\r","pos":1084}}],"text":"      \/\/\/ <\/value>\r","pos":1078}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1300}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":1308}}],"text":"\/\/\/ <summary>\r","pos":1306}}],"text":"      \/\/\/ <summary>\r","pos":1300}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1321}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Gets the numeric version of the operating system. This is the same as returned by \r","pos":1329}}],"text":"\/\/\/ Gets the numeric version of the operating system. This is the same as returned by \r","pos":1327}}],"text":"      \/\/\/ Gets the numeric version of the operating system. This is the same as returned by \r","pos":1321}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1415}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <see cref=\"System.Environment.OSVersion\"\/>.\r","pos":1423}}],"text":"\/\/\/ <see cref=\"System.Environment.OSVersion\"\/>.\r","pos":1421}}],"text":"      \/\/\/ <see cref=\"System.Environment.OSVersion\"\/>.\r","pos":1415}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1470}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":1478}}],"text":"\/\/\/ <\/summary>\r","pos":1476}}],"text":"      \/\/\/ <\/summary>\r","pos":1470}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1492}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <value>The numeric version of the operating system.<\/value>\r","pos":1500}}],"text":"\/\/\/ <value>The numeric version of the operating system.<\/value>\r","pos":1498}}],"text":"      \/\/\/ <value>The numeric version of the operating system.<\/value>\r","pos":1492}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1660}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":1668}}],"text":"\/\/\/ <summary>\r","pos":1666}}],"text":"      \/\/\/ <summary>\r","pos":1660}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1681}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Gets the version of the service pack currently installed on the operating system.\r","pos":1689}}],"text":"\/\/\/ Gets the version of the service pack currently installed on the operating system.\r","pos":1687}}],"text":"      \/\/\/ Gets the version of the service pack currently installed on the operating system.\r","pos":1681}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1774}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":1782}}],"text":"\/\/\/ <\/summary>\r","pos":1780}}],"text":"      \/\/\/ <\/summary>\r","pos":1774}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1796}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <value>The version of the service pack currently installed on the operating system.<\/value>\r","pos":1804}}],"text":"\/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>\r","pos":1802}}],"text":"      \/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>\r","pos":1796}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":1899}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are \r","pos":1907}}],"text":"\/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are \r","pos":1905}}],"text":"      \/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are \r","pos":1899}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2000}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ used.<\/remarks>\r","pos":2008}}],"text":"\/\/\/ used.<\/remarks>\r","pos":2006}}],"text":"      \/\/\/ used.<\/remarks>\r","pos":2000}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2261}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":2269}}],"text":"\/\/\/ <summary>\r","pos":2267}}],"text":"      \/\/\/ <summary>\r","pos":2261}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2282}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Gets the processor architecture for which the operating system is targeted.\r","pos":2290}}],"text":"\/\/\/ Gets the processor architecture for which the operating system is targeted.\r","pos":2288}}],"text":"      \/\/\/ Gets the processor architecture for which the operating system is targeted.\r","pos":2282}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2369}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":2377}}],"text":"\/\/\/ <\/summary>\r","pos":2375}}],"text":"      \/\/\/ <\/summary>\r","pos":2369}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2391}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <value>The processor architecture for which the operating system is targeted.<\/value>\r","pos":2399}}],"text":"\/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>\r","pos":2397}}],"text":"      \/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>\r","pos":2391}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2488}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to\r","pos":2496}}],"text":"\/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to\r","pos":2494}}],"text":"      \/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to\r","pos":2488}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2604}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ determine if this is the case.\r","pos":2612}}],"text":"\/\/\/ determine if this is the case.\r","pos":2610}}],"text":"      \/\/\/ determine if this is the case.\r","pos":2604}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2646}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/remarks>\r","pos":2654}}],"text":"\/\/\/ <\/remarks>\r","pos":2652}}],"text":"      \/\/\/ <\/remarks>\r","pos":2646}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":2980}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":2988}}],"text":"\/\/\/ <summary>\r","pos":2986}}],"text":"      \/\/\/ <summary>\r","pos":2980}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3001}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Determines whether the current process is running under WOW64.\r","pos":3009}}],"text":"\/\/\/ Determines whether the current process is running under WOW64.\r","pos":3007}}],"text":"      \/\/\/ Determines whether the current process is running under WOW64.\r","pos":3001}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3075}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":3083}}],"text":"\/\/\/ <\/summary>\r","pos":3081}}],"text":"      \/\/\/ <\/summary>\r","pos":3075}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3097}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <returns>\r","pos":3105}}],"text":"\/\/\/ <returns>\r","pos":3103}}],"text":"      \/\/\/ <returns>\r","pos":3097}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3118}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>.\r","pos":3126}}],"text":"\/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>.\r","pos":3124}}],"text":"      \/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>.\r","pos":3118}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3214}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/returns>      \r","pos":3222}}],"text":"\/\/\/ <\/returns>      \r","pos":3220}}],"text":"      \/\/\/ <\/returns>      \r","pos":3214}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3613}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":3621}}],"text":"\/\/\/ <summary>\r","pos":3619}}],"text":"      \/\/\/ <summary>\r","pos":3613}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3634}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Determines whether the operating system is of the specified version or later.\r","pos":3642}}],"text":"\/\/\/ Determines whether the operating system is of the specified version or later.\r","pos":3640}}],"text":"      \/\/\/ Determines whether the operating system is of the specified version or later.\r","pos":3634}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3723}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":3731}}],"text":"\/\/\/ <\/summary>\r","pos":3729}}],"text":"      \/\/\/ <\/summary>\r","pos":3723}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3745}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>\r","pos":3753}}],"text":"\/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>\r","pos":3751}}],"text":"      \/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>\r","pos":3745}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3838}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <returns>\r","pos":3846}}],"text":"\/\/\/ <returns>\r","pos":3844}}],"text":"      \/\/\/ <returns>\r","pos":3838}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3859}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>.\r","pos":3867}}],"text":"\/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>.\r","pos":3865}}],"text":"      \/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>.\r","pos":3859}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":3989}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/returns>      \r","pos":3997}}],"text":"\/\/\/ <\/returns>      \r","pos":3995}}],"text":"      \/\/\/ <\/returns>      \r","pos":3989}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4139}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":4147}}],"text":"\/\/\/ <summary>\r","pos":4145}}],"text":"      \/\/\/ <summary>\r","pos":4139}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4160}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Determines whether operating system is of the specified version or later, allowing specification of \r","pos":4168}}],"text":"\/\/\/ Determines whether operating system is of the specified version or later, allowing specification of \r","pos":4166}}],"text":"      \/\/\/ Determines whether operating system is of the specified version or later, allowing specification of \r","pos":4160}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4272}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ a minimum service pack that must be installed on the lowest version.\r","pos":4280}}],"text":"\/\/\/ a minimum service pack that must be installed on the lowest version.\r","pos":4278}}],"text":"      \/\/\/ a minimum service pack that must be installed on the lowest version.\r","pos":4272}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4352}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":4360}}],"text":"\/\/\/ <\/summary>\r","pos":4358}}],"text":"      \/\/\/ <\/summary>\r","pos":4352}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4374}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"version\">The minimum required version.<\/param>\r","pos":4382}}],"text":"\/\/\/ <param name=\"version\">The minimum required version.<\/param>\r","pos":4380}}],"text":"      \/\/\/ <param name=\"version\">The minimum required version.<\/param>\r","pos":4374}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4445}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the \r","pos":4453}}],"text":"\/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the \r","pos":4451}}],"text":"      \/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the \r","pos":4445}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4558}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>\r","pos":4566}}],"text":"\/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>\r","pos":4564}}],"text":"      \/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>\r","pos":4558}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4685}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <returns>\r","pos":4693}}],"text":"\/\/\/ <returns>\r","pos":4691}}],"text":"      \/\/\/ <returns>\r","pos":4685}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4706}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>.\r","pos":4714}}],"text":"\/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>.\r","pos":4712}}],"text":"      \/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>.\r","pos":4706}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":4911}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/returns>      \r","pos":4919}}],"text":"\/\/\/ <\/returns>      \r","pos":4917}}],"text":"      \/\/\/ <\/returns>      \r","pos":4911}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5162}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":5170}}],"text":"\/\/\/ <summary>\r","pos":5168}}],"text":"      \/\/\/ <summary>\r","pos":5162}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5183}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Determines whether operating system is of the specified server version or later or if it is of the specified client \r","pos":5191}}],"text":"\/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client \r","pos":5189}}],"text":"      \/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client \r","pos":5183}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5311}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":5319}}],"text":"\/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":5317}}],"text":"      \/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":5311}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5411}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":5419}}],"text":"\/\/\/ <\/summary>\r","pos":5417}}],"text":"      \/\/\/ <\/summary>\r","pos":5411}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5433}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"serverVersion\">The minimum server version.<\/param>\r","pos":5441}}],"text":"\/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>\r","pos":5439}}],"text":"      \/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>\r","pos":5433}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5508}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>\r","pos":5516}}],"text":"\/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>\r","pos":5514}}],"text":"      \/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>\r","pos":5508}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5682}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"clientVersion\">The minimum client version.<\/param>\r","pos":5690}}],"text":"\/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>\r","pos":5688}}],"text":"      \/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>\r","pos":5682}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":5757}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>\r","pos":5765}}],"text":"\/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>\r","pos":5763}}],"text":"      \/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>\r","pos":5757}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6333}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":6341}}],"text":"\/\/\/ <summary>\r","pos":6339}}],"text":"      \/\/\/ <summary>\r","pos":6333}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6354}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and\r","pos":6362}}],"text":"\/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and\r","pos":6360}}],"text":"      \/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and\r","pos":6354}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6496}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":6504}}],"text":"\/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":6502}}],"text":"      \/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r","pos":6496}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6626}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":6634}}],"text":"\/\/\/ <\/summary>\r","pos":6632}}],"text":"      \/\/\/ <\/summary>\r","pos":6626}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6648}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"serverVersion\">The server version.<\/param>\r","pos":6656}}],"text":"\/\/\/ <param name=\"serverVersion\">The server version.<\/param>\r","pos":6654}}],"text":"      \/\/\/ <param name=\"serverVersion\">The server version.<\/param>\r","pos":6648}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":6715}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>\r","pos":6723}}],"text":"\/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>\r","pos":6721}}],"text":"      \/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>\r","pos":6715}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7067}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":7075}}],"text":"\/\/\/ <summary>\r","pos":7073}}],"text":"      \/\/\/ <summary>\r","pos":7067}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7088}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/     Determines whether the assembly is executing on the specified operating system version or later.\r","pos":7096}}],"text":"\/\/\/     Determines whether the assembly is executing on the specified operating system version or later.\r","pos":7094}}],"text":"      \/\/\/     Determines whether the assembly is executing on the specified operating system version or later.\r","pos":7088}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7200}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/     If not, an exception is thrown.\r","pos":7208}}],"text":"\/\/\/     If not, an exception is thrown.\r","pos":7206}}],"text":"      \/\/\/     If not, an exception is thrown.\r","pos":7200}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7247}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":7255}}],"text":"\/\/\/ <\/summary>\r","pos":7253}}],"text":"      \/\/\/ <\/summary>\r","pos":7247}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7269}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":7277}}],"text":"\/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":7275}}],"text":"      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":7269}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7359}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      \r","pos":7367}}],"text":"\/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      \r","pos":7365}}],"text":"      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      \r","pos":7359}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7728}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <summary>\r","pos":7736}}],"text":"\/\/\/ <summary>\r","pos":7734}}],"text":"      \/\/\/ <summary>\r","pos":7728}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7749}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/     Determines whether the assembly is executing on the specified operating system version with\r","pos":7757}}],"text":"\/\/\/     Determines whether the assembly is executing on the specified operating system version with\r","pos":7755}}],"text":"      \/\/\/     Determines whether the assembly is executing on the specified operating system version with\r","pos":7749}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7856}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/     the specified service pack installed or any later version of windows. If not, an exception is thrown.\r","pos":7864}}],"text":"\/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown.\r","pos":7862}}],"text":"      \/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown.\r","pos":7856}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7973}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <\/summary>\r","pos":7981}}],"text":"\/\/\/ <\/summary>\r","pos":7979}}],"text":"      \/\/\/ <\/summary>\r","pos":7973}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":7995}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":8003}}],"text":"\/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":8001}}],"text":"      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r","pos":7995}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":8085}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>\r","pos":8093}}],"text":"\/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>\r","pos":8091}}],"text":"      \/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>\r","pos":8085}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":8180}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier \r","pos":8188}}],"text":"\/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier \r","pos":8186}}],"text":"      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier \r","pos":8180}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":8299}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not \r","pos":8307}}],"text":"\/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not \r","pos":8305}}],"text":"      \/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not \r","pos":8299}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"      ","pos":8415}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":"\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      \r","pos":8423}}],"text":"\/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      \r","pos":8421}}],"text":"      \/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      \r","pos":8415}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"            if (info.dwMinorVersion == 0) ","pos":10072}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":" Windows Vista or Windows Server 2008\r","pos":10116}}],"text":"\/\/ Windows Vista or Windows Server 2008\r","pos":10114}}],"text":"            if (info.dwMinorVersion == 0) \/\/ Windows Vista or Windows Server 2008\r","pos":10072}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) ","pos":10170}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":" Vista\r","pos":10246}}],"text":"\/\/ Vista\r","pos":10244}}],"text":"               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) \/\/ Vista\r","pos":10170}},{"cs.line_comment":{"subs":[{"cs.line_comment_context":{"text":"            else if (info.dwMinorVersion == 1) ","pos":10497}},{"cs.line_comment_body":{"subs":[{"cs.line_comment_text":{"text":" Windows 7 or Windows Server 2008 R2\r","pos":10546}}],"text":"\/\/ Windows 7 or Windows Server 2008 R2\r","pos":10544}}],"text":"            else if (info.dwMinorVersion == 1) \/\/ Windows 7 or Windows Server 2008 R2\r","pos":10497}}],"text":"using System;\r\nusing System.Diagnostics;\r\nusing System.Globalization;\r\nusing System.Runtime.InteropServices;\r\nusing System.Security.Permissions;\r\n\r\nnamespace Alphaleonis.Win32.Vss\r\n{   \r\n   \/\/\/ <summary>\r\n   \/\/\/ Static class providing access to information about the operating system under which the\r\n   \/\/\/ assembly is executing.\r\n   \/\/\/ <\/summary>\r\n   public static class OperatingSystemInfo\r\n   {\r\n      #region Public Properties\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Gets the named version of the operating system.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <value>The named version of the operating system.<\/value>\r\n      public static OSVersionName OSVersionName\r\n      {         \r\n         get\r\n         {\r\n            if (s_servicePackVersion == null)\r\n               UpdateData();\r\n            return s_osVersionName;\r\n         }\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Gets a value indicating whether the operating system is a server os.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <value>\r\n      \/\/\/   <c>true<\/c> if the current operating system is a server os; otherwise, <c>false<\/c>.\r\n      \/\/\/ <\/value>\r\n      public static bool IsServer\r\n      {\r\n         get\r\n         {\r\n            if (s_servicePackVersion == null)\r\n               UpdateData();\r\n            return s_isServer;\r\n         }\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Gets the numeric version of the operating system. This is the same as returned by \r\n      \/\/\/ <see cref=\"System.Environment.OSVersion\"\/>.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <value>The numeric version of the operating system.<\/value>\r\n      public static Version OSVersion\r\n      {\r\n         get { return s_osVersion; }\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Gets the version of the service pack currently installed on the operating system.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <value>The version of the service pack currently installed on the operating system.<\/value>\r\n      \/\/\/ <remarks>Only the <see cref=\"Version.Major\"\/> and <see cref=\"Version.Minor\"\/> fields are \r\n      \/\/\/ used.<\/remarks>\r\n      public static Version ServicePackVersion\r\n      {         \r\n         get\r\n         {\r\n            if (s_servicePackVersion == null)\r\n               UpdateData();\r\n            return s_servicePackVersion;\r\n         }\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Gets the processor architecture for which the operating system is targeted.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <value>The processor architecture for which the operating system is targeted.<\/value>\r\n      \/\/\/ <remarks>If running under WOW64 this will return a 32-bit processor. Use <see cref=\"IsWow64Process\"\/> to\r\n      \/\/\/ determine if this is the case.\r\n      \/\/\/ <\/remarks>\r\n      public static ProcessorArchitecture ProcessorArchitecture\r\n      {         \r\n         get\r\n         {\r\n            if (s_servicePackVersion == null)\r\n               UpdateData();\r\n            return s_processorArchitecture;\r\n         }\r\n      }\r\n\r\n      #endregion\r\n\r\n      #region Public Methods\r\n      \r\n      \/\/\/ <summary>\r\n      \/\/\/ Determines whether the current process is running under WOW64.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <returns>\r\n      \/\/\/ \t<c>true<\/c> if the current process is running under WOW64; otherwise, <c>false<\/c>.\r\n      \/\/\/ <\/returns>      \r\n      public static bool IsWow64Process()\r\n      {\r\n         IntPtr processHandle = System.Diagnostics.Process.GetCurrentProcess().Handle;\r\n         bool value = false;\r\n         if (!NativeMethods.IsWow64Process(processHandle, out value))\r\n         {\r\n            Marshal.ThrowExceptionForHR(Marshal.GetLastWin32Error());\r\n         }\r\n         return value;\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Determines whether the operating system is of the specified version or later.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"version\">The lowest version for which to return <c>true<\/c>.<\/param>\r\n      \/\/\/ <returns>\r\n      \/\/\/ \t<c>true<\/c> if the operating system is of the specified <paramref name=\"version\"\/> or later; otherwise, <c>false<\/c>.\r\n      \/\/\/ <\/returns>      \r\n      public static bool IsAtLeast(OSVersionName version)\r\n      {\r\n         return OSVersionName >= version;\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Determines whether operating system is of the specified version or later, allowing specification of \r\n      \/\/\/ a minimum service pack that must be installed on the lowest version.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"version\">The minimum required version.<\/param>\r\n      \/\/\/ <param name=\"servicePackVersion\">The major version of the service pack that must be installed on the \r\n      \/\/\/ minimum required version to return <c>true<\/c>. This can be 0 to indicate that no service pack is required.<\/param>\r\n      \/\/\/ <returns>\r\n      \/\/\/ \t<c>true<\/c> if the operating system matches the specified <paramref name=\"version\"\/> with the specified service pack, or if the operating system is of a later version; otherwise, <c>false<\/c>.\r\n      \/\/\/ <\/returns>      \r\n      public static bool IsAtLeast(OSVersionName version, int servicePackVersion)\r\n      {\r\n         return OSVersionName == version && ServicePackVersion.Major >= servicePackVersion || OSVersionName > version;\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Determines whether operating system is of the specified server version or later or if it is of the specified client \r\n      \/\/\/ version or later and throws <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"serverVersion\">The minimum server version.<\/param>\r\n      \/\/\/ <param name=\"serverServicePackVersion\">The minimum server service pack version (applies only if the version exactly matches the specified server version).<\/param>\r\n      \/\/\/ <param name=\"clientVersion\">The minimum client version.<\/param>\r\n      \/\/\/ <param name=\"clientServicePackVersion\">The minimum client service pack version (applies only if the version exactly matches the specified client version).<\/param>\r\n      public static void RequireServerOrClientAtLeast(OSVersionName serverVersion, int serverServicePackVersion, OSVersionName clientVersion, int clientServicePackVersion)\r\n      {\r\n         if (IsServer && !IsAtLeast(serverVersion, serverServicePackVersion) || !IsServer && !IsAtLeast(clientVersion, clientServicePackVersion))\r\n            throw new UnsupportedOperatingSystemException();\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/ Determines whether the operating system is a server operating system of atleast the specified <paramref name=\"serverVersion\"\/> and\r\n      \/\/\/ <paramref name=\"serverServicePackVersion\"\/> and throws an <see cref=\"UnsupportedOperatingSystemException\"\/> otherwise.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"serverVersion\">The server version.<\/param>\r\n      \/\/\/ <param name=\"serverServicePackVersion\">The server service pack version.<\/param>\r\n      public static void RequireServer(OSVersionName serverVersion, int serverServicePackVersion)\r\n      {\r\n         if (!IsServer || !IsAtLeast(serverVersion, serverServicePackVersion))\r\n            throw new UnsupportedOperatingSystemException();\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/     Determines whether the assembly is executing on the specified operating system version or later.\r\n      \/\/\/     If not, an exception is thrown.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r\n      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier than the specified <paramref name=\"osVersion\"\/><\/exception>      \r\n      public static void RequireAtLeast(OSVersionName osVersion)\r\n      {\r\n         if (!IsAtLeast(osVersion))\r\n            throw new UnsupportedOperatingSystemException();\r\n      }\r\n\r\n      \/\/\/ <summary>\r\n      \/\/\/     Determines whether the assembly is executing on the specified operating system version with\r\n      \/\/\/     the specified service pack installed or any later version of windows. If not, an exception is thrown.\r\n      \/\/\/ <\/summary>\r\n      \/\/\/ <param name=\"osVersion\">The minimum operating system version required.<\/param>\r\n      \/\/\/ <param name=\"servicePackVersion\">The minimum service pack version required.<\/param>\r\n      \/\/\/ <exception cref=\"UnsupportedOperatingSystemException\">The current operating system is of a version earlier \r\n      \/\/\/ than the specified <paramref name=\"osVersion\"\/> or the versions match but the operating system does not \r\n      \/\/\/ have at least the specified service pack version <paramref name=\"servicePackVersion\"\/> installed.<\/exception>      \r\n      public static void RequireAtLeast(OSVersionName osVersion, int servicePackVersion)\r\n      {\r\n         if (!IsAtLeast(osVersion, servicePackVersion))\r\n            throw new UnsupportedOperatingSystemException();\r\n      }\r\n\r\n      #endregion\r\n\r\n      #region Private members            \r\n      \r\n      private static void UpdateData()\r\n      {\r\n         NativeMethods.OSVERSIONINFOEX info = new NativeMethods.OSVERSIONINFOEX();\r\n         info.dwOSVersionInfoSize = Marshal.SizeOf(info);\r\n\r\n         NativeMethods.SYSTEM_INFO sysInfo = new NativeMethods.SYSTEM_INFO();\r\n\r\n         NativeMethods.GetSystemInfo(out sysInfo);\r\n         if (!NativeMethods.GetVersionExW(ref info))\r\n         {\r\n            Marshal.ThrowExceptionForHR(Marshal.GetLastWin32Error());\r\n         }\r\n\r\n         Debug.Assert(info.dwMajorVersion == Environment.OSVersion.Version.Major);\r\n         Debug.Assert(info.dwMinorVersion == Environment.OSVersion.Version.Minor);\r\n         Debug.Assert(info.dwBuildNumber == Environment.OSVersion.Version.Build);\r\n\r\n         s_processorArchitecture = (ProcessorArchitecture)sysInfo.processorArchitecture;\r\n\r\n         s_servicePackVersion = new Version(info.wServicePackMajor, info.wServicePackMinor);\r\n\r\n         s_isServer = info.wProductType == NativeMethods.VER_NT_DOMAIN_CONTROLLER || info.wProductType == NativeMethods.VER_NT_SERVER;\r\n\r\n         if (info.dwMajorVersion > 6)\r\n         {\r\n            s_osVersionName = OSVersionName.Later;\r\n         }\r\n         else if (info.dwMajorVersion == 6) \r\n         {\r\n            if (info.dwMinorVersion == 0) \/\/ Windows Vista or Windows Server 2008\r\n            {\r\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION) \/\/ Vista\r\n               {\r\n                  s_osVersionName = OSVersionName.WindowsVista;\r\n               }\r\n               else\r\n               {\r\n                  s_osVersionName = OSVersionName.WindowsServer2008;\r\n               }\r\n            }\r\n            else if (info.dwMinorVersion == 1) \/\/ Windows 7 or Windows Server 2008 R2\r\n            {\r\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION)\r\n               {\r\n                  s_osVersionName = Vss.OSVersionName.Windows7;\r\n               }\r\n               else\r\n               {\r\n                  s_osVersionName = Vss.OSVersionName.WindowsServer2008R2;\r\n               }\r\n            }\r\n            else\r\n            {\r\n               s_osVersionName = Vss.OSVersionName.Later;\r\n            }\r\n         }\r\n         else if (info.dwMajorVersion == 5)\r\n         {\r\n            if (info.dwMinorVersion == 0)\r\n            {\r\n               s_osVersionName = OSVersionName.Windows2000;\r\n            }\r\n            if (info.dwMinorVersion == 1)\r\n            {\r\n               s_osVersionName = OSVersionName.WindowsXP;\r\n            }\r\n            else if (info.dwMinorVersion == 2)\r\n            {\r\n               if (info.wProductType == NativeMethods.VER_NT_WORKSTATION && s_processorArchitecture == ProcessorArchitecture.X64)\r\n               {\r\n                  s_osVersionName = OSVersionName.WindowsXP;\r\n               }\r\n               else if (info.wProductType != NativeMethods.VER_NT_WORKSTATION)\r\n               {\r\n                  s_osVersionName = OSVersionName.WindowsServer2003;\r\n               }\r\n               else\r\n               {\r\n                  s_osVersionName = OSVersionName.Later;\r\n               }\r\n            }\r\n            else\r\n            {\r\n               s_osVersionName = OSVersionName.Later;\r\n            }\r\n         }\r\n      }\r\n\r\n      private static OSVersionName s_osVersionName = OSVersionName.Later;\r\n      private static Version s_osVersion = Environment.OSVersion.Version;\r\n      private static Version s_servicePackVersion;\r\n      private static ProcessorArchitecture s_processorArchitecture;\r\n      private static bool s_isServer;\r\n\r\n      #endregion\r\n\r\n      #region P\/Invoke members\r\n\r\n      private static class NativeMethods\r\n      {\r\n         [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\r\n         public struct OSVERSIONINFOEX\r\n         {\r\n            public int dwOSVersionInfoSize;\r\n            public int dwMajorVersion;\r\n            public int dwMinorVersion;\r\n            public int dwBuildNumber;\r\n            public int dwPlatformId;\r\n            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]\r\n            public string szCSDVersion;\r\n            public UInt16 wServicePackMajor;\r\n            public UInt16 wServicePackMinor;\r\n            public UInt16 wSuiteMask;\r\n            public byte wProductType;\r\n            public byte wReserved;\r\n         }\r\n\r\n         [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2205:UseManagedEquivalentsOfWin32Api\")]\r\n         [DllImport(\"kernel32\", CharSet = CharSet.Unicode, SetLastError = true)]\r\n         [return: MarshalAs(UnmanagedType.Bool)]\r\n         public static extern bool GetVersionExW(ref OSVERSIONINFOEX osvi);\r\n\r\n         [StructLayout(LayoutKind.Sequential)]\r\n         public struct SYSTEM_INFO\r\n         {\r\n            public ushort processorArchitecture;\r\n            ushort reserved;\r\n            public uint pageSize;\r\n            public IntPtr minimumApplicationAddress;\r\n            public IntPtr maximumApplicationAddress;\r\n            public IntPtr activeProcessorMask;\r\n            public uint numberOfProcessors;\r\n            public uint processorType;\r\n            public uint allocationGranularity;\r\n            public ushort processorLevel;\r\n            public ushort processorRevision;\r\n         }\r\n\r\n         [DllImport(\"kernel32.dll\")]\r\n         public static extern void GetSystemInfo(out SYSTEM_INFO lpSystemInfo);\r\n\r\n         public const short VER_NT_WORKSTATION = 1;\r\n         public const short VER_NT_DOMAIN_CONTROLLER = 2;\r\n         public const short VER_NT_SERVER = 3;\r\n\r\n         [DllImport(\"kernel32.dll\", SetLastError = true, CallingConvention = CallingConvention.Winapi)]\r\n         [return: MarshalAs(UnmanagedType.Bool)]\r\n         public static extern bool IsWow64Process(\r\n              [In] IntPtr hProcess,\r\n              [Out, MarshalAs(UnmanagedType.Bool)] out bool lpSystemInfo\r\n              );\r\n      }\r\n      #endregion\r\n   }\r\n","pos":1}}
